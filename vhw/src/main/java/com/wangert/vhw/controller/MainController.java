package com.wangert.vhw.controller;

import com.wangert.vhw.service.HomeDataAcquireService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;

import javax.servlet.http.HttpSession;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 *
 * 主页控制层
 * @Author：Wangert
 *
 */

@Controller
public class MainController {

    @Autowired
    HomeDataAcquireService homeDataAcquireService;
    @RequestMapping("/homePage")
    public String homePage(Model model) {

        List<Map<String, Object>> patchList = new ArrayList<>();
/*
        Map<String, Object> map1 = new HashMap<>();
        map1.put("ipfsHash", "QmY4QYLFo1ZkobL63d5aYb7dLURjmpjcBwAL9raxkqYYE8");
        map1.put("vulnerabilityHash", "QmTuSjAM7wdpAmWDrTABWgguwUfCXPfmYnRLvDiTCBj5w9");
        map1.put("patchName", "patchOfVulnerabilityGGG");
        map1.put("username", "wangjitao");
        map1.put("releaseDate", "2019/09/29 13:23:11");
        map1.put("description", "1.test/n2.testtest");
        map1.put("star", 23);
        map1.put("score", 0);

        patchList.add(map1);
        //System.out.println(vulnerabilityList.get(0).get("ipfsHash"));

        Map<String, Object> map2 = new HashMap<>();
        map2.put("ipfsHash", "QmSsw6EcnwEiTT9c4rnAGeSENvsJMepNHmbrgi2S9bXNJr");
        map2.put("vulnerabilityHash", "QmbFMke1KXqnYyBBWxB74N4c5SBnJMVAiMNRcGu6x1AwQH");
        map2.put("patchName", "patchOfVhw_001");
        map2.put("username", "guyu");
        map2.put("releaseDate", "2019/09/29 23:23:11");
        map2.put("description", "1.test/n2.testtest");
        map2.put("star", 234);
        map2.put("score", 12);

        patchList.add(map2);
        //System.out.println(vulnerabilityList.get(1).get("ipfsHash"));

        Map<String, Object> map3 = new HashMap<>();
        map3.put("ipfsHash", "QmUgAgTVxq7UeY3Tbumz72fBsSvkUnveEgEkWvVquEvJVV");
        map3.put("vulnerabilityHash", "QmbFMke1KXqnYyBBWxB74N4c5SBnJMVAiMNRcGu6x1AwQH");
        map3.put("patchName", "patchOfVhw_002");
        map3.put("username", "wangjitao");
        map3.put("releaseDate", "2019/09/28 23:44:11");
        map3.put("description", "1.test/n2.testtest");
        map3.put("star", 2034);
        map3.put("score", 234);

        patchList.add(map3);
        //System.out.println(vulnerabilityList.get(2).get("ipfsHash"));

        //System.out.println(vulnerabilityList.size());

        //Map<String, Object> map2 = new HashMap<>();
        //map2.put("username", "test2");
        //map2.put("totalContribution", 54677);
        //map2.put("residualContribution", 10023);

        //System.out.println(map2);

        //vulnerabilityList.add(map2);
*/
        //===============添加贡献榜单数据==================================================
        List<Map<String, Object>> userContributionList = new ArrayList<>();
        List<Map<String, Object>> vulnerabilityList = new ArrayList<>();

        //获取主页数据
        userContributionList = homeDataAcquireService.acquireUserContributionList();
        vulnerabilityList = homeDataAcquireService.acquireVulnerabilityList();
        patchList = homeDataAcquireService.acquirePatchList();

        model.addAttribute("userContributionList", userContributionList);

        model.addAttribute("vulnerabilityList", vulnerabilityList);

        model.addAttribute("patchList", patchList);


        //System.out.println(homePageList.get(0).get("username"));

        //session.setAttribute("homePageList", homePageList);

        return "main";
    }

}
