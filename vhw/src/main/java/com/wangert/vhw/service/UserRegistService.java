package com.wangert.vhw.service;

import com.wangert.vhw.utils.ECCUtil;
import com.wangert.vhw.utils.PropertyUtil;
import org.bouncycastle.util.encoders.Base64;
import org.springframework.stereotype.Service;

import java.security.PrivateKey;
import java.security.PublicKey;

/**
 *
 * 用户注册服务类
 * @Author：Wangert
 *
 */

@Service
public class UserRegistService {

    public UserRegistService() {}


    public String getVhwAddressByUsername(String username) {

        ECCUtil ecc1 = new ECCUtil();

        byte[] cipher = "".getBytes();

        PropertyUtil propertyUtil = new PropertyUtil("src/main/resources/config/keyPair.properties");

        try {

            PublicKey publicKey = ecc1.stringToPublicKey(propertyUtil.getData("vhwAddressPublicKey").getBytes());
            PrivateKey privateKey = ecc1.stringToPrivateKey(propertyUtil.getData("vhwAddressPrivateKey").getBytes());

            byte[] content = username.getBytes();

            cipher = ecc1.publicEncrypt(content, publicKey);

        }catch (Exception e) {

            e.printStackTrace();

        }

        byte[] base64Cipher = Base64.encode(cipher);


        return base64Cipher.toString();

    }

/*
    public static void main(String[] args) {

        UserRegistService userRegistService = new UserRegistService();

        String vhwAddress = userRegistService.getVhwAddressByUsername("wangjitao");

        System.out.println(vhwAddress);


    }

*/

}
